# 4.安全和审计
## 4.1.安全和审计
GridGain提供了一套安全功能，可为远程客户端和其他集群节点开启访问控制。它们是通过配置可插拔的身份验证和授权机制、以及完整的审计功能来实现的，这些功能可以回放系统中的任何事件，以追溯需对该事件负责的用户。
### 4.1.1.认证
GridGain支持可插拔的`Authenticator`，用户可以将任何现有的身份验证机制插入GridGain。GridGain直接支持基于密码和基于JAAS的身份验证机制。通过基于JAAS的实现，GridGain能够自动支持JNDI、LDAP、活动目录以及其它任何符合JAAS的身份验证和授权机制。

为了进行身份验证，客户端或集群节点需要提供有效的用户名和密码，如果身份验证成功，GridGain将为经过身份验证的主题生成可用权限列表。
### 4.1.2.授权
经过身份验证后，会为主题提供预配置的授权权限列表。GridGain允许为任何数据更改操作、闭包或任务执行、数据查询和查看以及管理和监视设置权限。`SecurityPermission`枚举定义了所有可用权限的完整列表，大多数权限都是缓存级的，因此同一个用户，例如，可能对一个缓存具有READ和WRITE权限，而对另一个缓存只具有QUERY权限。

授权功能通过`Security`API暴露给用户的，以便在需要自定义逻辑时允许在业务代码中进行手动授权检查。

还可以为Visor管理和监控工具设置所有可用的安全权限。
### 4.1.3.审计能力
如果发生了意外的事件，能够回放发生的事件并追溯应对该事件负责的经过身份验证的主体非常重要。GridGain具有多种审计机制，可确保系统中发生的每个事件都是可追溯的：

 1. 系统中的每个事件都绝对包含经过身份验证的主体的用户名，这确保每个事件都有责任方的信息；
 2. 除用户名外，每个事件还包含责任方的IP地址、集群节点IP地址、更改前后的受影响数据；
 3. 如果一个事件是由另一个事件引起的，则子事件将具有关于父事件的审计信息。例如，如果从闭包或任务触发了缓存PUT操作，则缓存PUT事件将包含有关父任务执行事件的信息，依此类推；
 4. 除了能够追溯所有直接的数据访问操作和查询之外，用户还可以追溯间接访问。例如，如果数据不是从服务端数据节点访问，而是从客户端近缓存或远程连续查询通知访问，则它仍将作为单独的事件进行记录；
 5. 每个事件都由`EventStorage`SPI记录。该SPI提供了一种可插拔的机制，可以将事件记录为任何所需格式、记录到任何底层存储系统，无论是文件系统还是任何数据库；
 6. 存储在缓存中的所有数据都包含有关字段的元数据信息，因此在打印输出时，所有字段名都会与值一起列出，这样用户就可以立即知道哪个字段已更改，而无需追溯和关联不同的日志。

::: tip 保护集群的两种方法
可以通过两种方式配置安全性：使用GridGain身份验证和授权机制或Ignite的[身份验证机制](/doc/java/Security.md#_4-2-高级安全)，不过GridGain的安全性和Ignite的安全性是互斥的，同时只能使用一个，建议使用GridGain的安全性，因为它提供了更广泛的功能。
:::